{"version":3,"sources":["Game.js"],"names":[],"mappings":"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","file":"Game-compiled.js","sourcesContent":["var gridSize = 6;\r\nvar enemies = [];\r\nvar fieldManager;\r\n\r\nclass Game {\r\n    constructor(){\r\n        game = this;\r\n        canvas = document.getElementById('game');\r\n        ctx = canvas.getContext('2d');\r\n\r\n        this.player = new Player(0, 0);\r\n        fieldManager = new FieldManager();\r\n        enemies.push(new Enemy(20, 50));\r\n\r\n        frame(); // start the first frame\r\n    }\r\n\r\n    render(ctx, dt){\r\n        //console.log('game render dt: ', dt);\r\n        ctx.clearRect(0, 0, canvas.clientWidth, canvas.clientHeight);\r\n        fieldManager.render(ctx);\r\n        this.player.render(ctx);\r\n\r\n        for(var i = 0; i < enemies.length; i++){\r\n            enemies[i].render(ctx);\r\n        }\r\n    }\r\n\r\n    update(dt){\r\n        //console.log('game update: ', dt);\r\n        this.player.update(dt);\r\n    }\r\n}\r\n\r\nclass Player{\r\n    constructor(posX, posY){\r\n        this.x = posX;\r\n        this.y = posY;\r\n\r\n        this.size = 5;\r\n        this.speed = 2;\r\n        this.direction = {\r\n            x: 0,\r\n            y: 0\r\n        };\r\n        this.color = '#333';\r\n        this.color2 = '#f00';\r\n        this.isDrawing = false;\r\n        this.isMoving = false;\r\n\r\n        this.currentRect = [];\r\n\r\n        document.addEventListener('keydown', (ev) => { return this.keyDown(ev.keyCode);  }, false);\r\n    }\r\n\r\n    addNewPosition(){\r\n        this.currentRect.push({ x: this.x, y: this.y });\r\n        //console.log('currentRect: ', this.currentRect);\r\n    }\r\n\r\n    resetCurrentPosition(){\r\n        this.currentRect = [];\r\n    }\r\n\r\n    stop(){\r\n        this.direction.x = 0;\r\n        this.direction.y = 0;\r\n\r\n        if(this.isDrawing){\r\n            this.addNewPosition();\r\n            fieldManager.addNewField(this.currentRect);\r\n            this.resetCurrentPosition();\r\n\r\n            if(this.x < this.size + 1){\r\n                this.x = 0;\r\n            } else if(this.x > canvas.clientWidth - this.size - gridSize - 1){\r\n                this.x = canvas.clientWidth - this.size;\r\n            } else if(this.y < this.size + 1){\r\n                this.y = 0\r\n            } else if(this.y > canvas.clientHeight - this.size - gridSize - 1){\r\n                this.y = canvas.clientHeight - this.size;\r\n            }\r\n        }\r\n\r\n        this.isDrawing = false;\r\n        this.isMoving = false;\r\n    }\r\n\r\n    move(dir){\r\n        this.isMoving = true;\r\n        this.direction = dir;\r\n\r\n        if(this.isDrawing){\r\n            this.addNewPosition();\r\n        }\r\n    }\r\n\r\n    keyDown(keyCode) {\r\n        if(keyCode == 37){\r\n            this.move({ x: -1, y: 0 })\r\n        }else if(keyCode == 38){\r\n            this.move({ x: 0, y: -1 })\r\n        } else if(keyCode == 39){\r\n            this.move({ x: 1, y: 0 })\r\n        } else if(keyCode == 40){\r\n            this.move({ x: 0, y: 1 })\r\n        } else if(keyCode == 32){\r\n            if(!this.isDrawing){\r\n                this.stop();\r\n            }\r\n        }\r\n    }\r\n\r\n    render(ctx){\r\n        if(this.isDrawing){\r\n            ctx.fillStyle = this.color2;\r\n        } else {\r\n            ctx.fillStyle = this.color;\r\n        }\r\n        ctx.fillRect(this.x, this.y, this.size, this.size);\r\n\r\n        for(var i = 0; i < this.currentRect.length; i++){\r\n            ctx.fillRect(this.currentRect[i].x, this.currentRect[i].y, gridSize, gridSize);\r\n        }\r\n    }\r\n\r\n    update(dt){\r\n        this.x += this.speed * this.direction.x;\r\n        this.y += this.speed * this.direction.y;\r\n\r\n        if(this.x > canvas.clientWidth - this.size/2){\r\n            this.x = -this.size/2;\r\n        } else if(this.x < -this.size/2){\r\n            this.x = canvas.clientWidth - this.size/2;\r\n        }\r\n\r\n        if(this.y > canvas.clientHeight - this.size/2){\r\n            this.y = -this.size/2;\r\n        } else if(this.y < -this.size/2){\r\n            this.y = canvas.clientHeight - this.size/2;\r\n        }\r\n\r\n        var isOvelap = false;\r\n        for(let i = 0; i < fieldManager.rectangles.length; i++){\r\n            let x1 = fieldManager.rectangles[i][0];\r\n            let y1 = fieldManager.rectangles[i][1];\r\n            let x2 = x1 + fieldManager.rectangles[i][2];\r\n            let y2 = y1 + fieldManager.rectangles[i][3];\r\n\r\n            if(x1 - gridSize < this.x && x2 > this.x && y1 - gridSize < this.y && y2 > this.y){\r\n                isOvelap = true;\r\n            }\r\n        }\r\n\r\n        if(isOvelap){\r\n            //console.log('player overlap!');\r\n\r\n            if(this.isDrawing){\r\n                this.stop();\r\n            }\r\n\r\n        } else {\r\n            if(this.isMoving){\r\n                this.isDrawing = true;\r\n                if(this.currentRect.length == 0){\r\n                    this.addNewPosition();\r\n                }\r\n                //console.log('isDrawing!');\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\nclass FieldManager{\r\n    constructor(){\r\n        this.rectangles = [];\r\n        this.rectangles.push(\r\n            [0, 0, canvas.clientWidth, gridSize],\r\n            [canvas.clientWidth - gridSize, 0, gridSize, canvas.clientHeight],\r\n            [0, canvas.clientHeight - gridSize, canvas.clientWidth, gridSize],\r\n            [0, 0, gridSize, canvas.clientHeight]\r\n        );\r\n        this.color = '#888';\r\n\r\n        this.currentRect = [];\r\n    }\r\n\r\n    addNewField(array){\r\n        console.log('addNewField: ', array);\r\n    }\r\n\r\n    render(ctx){\r\n        ctx.fillStyle = this.color;\r\n\r\n        for(let i = 0; i < this.rectangles.length; i++){\r\n            let x = this.rectangles[i][0];\r\n            let y = this.rectangles[i][1];\r\n            let width = this.rectangles[i][2];\r\n            let height = this.rectangles[i][3];\r\n\r\n            ctx.fillRect(x, y, width, height);\r\n        }\r\n    }\r\n}\r\n\r\nclass Enemy{\r\n    constructor(x, y){\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n\r\n    render(ctx){\r\n        ctx.beginPath();\r\n        ctx.arc(this.x, this.y, gridSize/2, 0, 2 * Math.PI, false);\r\n        ctx.fillStyle = 'blue';\r\n        ctx.fill();\r\n        //ctx.lineWidth = 1;\r\n        //ctx.strokeStyle = '#003300';\r\n        //ctx.stroke();\r\n    }\r\n}"]}